{
  "hash": "612fba3bfaa00c94623e9474d713d06f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 3: Spatiotemporal Rainfall Analysis\"\nauthor: \"Wong Zi Qi\"\ndate: \"March 24, 2025\"\ndate-modified: \"March 24, 2025\"\nexecute: \n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n\n# Overview\n\n# 1. Getting Started\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, lubridate, SmartEDA, ggplot2, tsibble, feasts, seasonal,\n               imputeTS, fable, changepoint)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nweather <- read.csv(\"data/weather_data.csv\")\nactive_stations <- read.csv(\"data/active_rainfall_stations.csv\")\n```\n:::\n\n\n\n# 2. Data Pre-processing\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# remove () for consistent naming\nweather$Station <- gsub(\"[()]\", \"\", trimws(as.character(weather$Station)))\nactive_stations$Station.Name <- gsub(\"[()]\", \"\", trimws(as.character(active_stations$Station.Name)))\n```\n:::\n\n\n\nNow that both active stations and weather data have consistent naming, with 27 distinct values, we filter stations that are active.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweather_active <- weather %>% \n  filter(Station %in% active_stations$Station.Name)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nweather_active <- weather_active %>%\n  select(Station, Year, Month, Day, Daily.Rainfall.Total..mm.) %>%\n  filter(!is.na(Daily.Rainfall.Total..mm.)) %>%\n  merge(active_stations, by.x = \"Station\", by.y = \"Station.Name\") %>%\n  select(Station, Year, Month, Day, Daily.Rainfall.Total..mm., Latitude, Longitude) %>%\n  mutate(Date = make_date(Year, Month, Day), Station = as.factor(Station)) %>%\n  arrange(Station, Date)\n```\n:::\n\n\n\n# 3. EDA\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweather_active %>% ExpData(type = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                          Descriptions    Value\n1                                   Sample size (nrow)    64853\n2                              No. of variables (ncol)        8\n3                    No. of numeric/interger variables        6\n4                              No. of factor variables        1\n5                                No. of text variables        0\n6                             No. of logical variables        0\n7                          No. of identifier variables        0\n8                                No. of date variables        1\n9             No. of zero variance variables (uniform)        0\n10               %. of variables having complete cases 100% (8)\n11   %. of variables having >0% and <50% missing cases   0% (0)\n12 %. of variables having >=50% and <90% missing cases   0% (0)\n13          %. of variables having >=90% missing cases   0% (0)\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nweather_active %>% ExpData(type = 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Index             Variable_Name Variable_Type Sample_n Missing_Count\n1     1                   Station        factor    64853             0\n2     2                      Year       numeric    64853             0\n3     3                     Month       numeric    64853             0\n4     4                       Day       numeric    64853             0\n5     5 Daily.Rainfall.Total..mm.       numeric    64853             0\n6     6                  Latitude       numeric    64853             0\n7     7                 Longitude       numeric    64853             0\n8     8                      Date          Date    64853             0\n  Per_of_Missing No_of_distinct_values\n1              0                    27\n2              0                     7\n3              0                    12\n4              0                    31\n5              0                   679\n6              0                    27\n7              0                    27\n8              0                  2557\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# explore how rainfall varies across stations\nExpNumStat(weather_active, \n           by = \"GA\", \n           gp = \"Station\", \n           round = 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                        Vname                          Group    TN nNeg nZero\n3   Daily.Rainfall.Total..mm.                    Station:All 64853    0 29880\n8   Daily.Rainfall.Total..mm.         Station:Botanic Garden  1882    0   860\n13  Daily.Rainfall.Total..mm.          Station:Bukit Panjang  2416    0  1025\n18  Daily.Rainfall.Total..mm.            Station:Bukit Timah  2541    0  1141\n23  Daily.Rainfall.Total..mm.            Station:Buona Vista  2331    0  1110\n28  Daily.Rainfall.Total..mm.  Station:Choa Chu Kang Central  2482    0  1071\n33  Daily.Rainfall.Total..mm.            Station:Jurong Pier  2497    0  1099\n38  Daily.Rainfall.Total..mm.             Station:Kent Ridge  2367    0  1072\n43  Daily.Rainfall.Total..mm.       Station:Kranji Reservoir  2507    0  1059\n48  Daily.Rainfall.Total..mm.           Station:Lim Chu Kang  2453    0  1038\n53  Daily.Rainfall.Total..mm. Station:Lower Peirce Reservoir  2530    0  1081\n58  Daily.Rainfall.Total..mm.   Station:Macritchie Reservoir  2515    0  1071\n63  Daily.Rainfall.Total..mm.                 Station:Mandai  2526    0  1045\n68  Daily.Rainfall.Total..mm.          Station:Marine Parade  2532    0  1283\n73  Daily.Rainfall.Total..mm.         Station:Nicoll Highway  2523    0  1221\n78  Daily.Rainfall.Total..mm.      Station:Pasir Ris Central  2533    0  1246\n83  Daily.Rainfall.Total..mm.         Station:Pasir Ris West  2222    0  1098\n88  Daily.Rainfall.Total..mm.                Station:Punggol  2557    0  1204\n93  Daily.Rainfall.Total..mm.             Station:Queenstown  2552    0  1199\n98  Daily.Rainfall.Total..mm.              Station:Serangoon   889    0   674\n103 Daily.Rainfall.Total..mm.                  Station:Simei  2435    0  1239\n108 Daily.Rainfall.Total..mm.          Station:Somerset Road  2542    0  1191\n113 Daily.Rainfall.Total..mm.         Station:Tanjong Katong  2553    0  1237\n118 Daily.Rainfall.Total..mm.              Station:Toa Payoh  2547    0  1151\n123 Daily.Rainfall.Total..mm.                   Station:Tuas  2553    0  1161\n128 Daily.Rainfall.Total..mm.             Station:Ulu Pandan  2478    0  1103\n133 Daily.Rainfall.Total..mm. Station:Upper Peirce Reservoir  2396    0  1023\n138 Daily.Rainfall.Total..mm.                Station:Whampoa  2494    0  1178\n2                         Day                    Station:All 64853    0     0\n7                         Day         Station:Botanic Garden  1882    0     0\n12                        Day          Station:Bukit Panjang  2416    0     0\n17                        Day            Station:Bukit Timah  2541    0     0\n22                        Day            Station:Buona Vista  2331    0     0\n27                        Day  Station:Choa Chu Kang Central  2482    0     0\n32                        Day            Station:Jurong Pier  2497    0     0\n37                        Day             Station:Kent Ridge  2367    0     0\n42                        Day       Station:Kranji Reservoir  2507    0     0\n47                        Day           Station:Lim Chu Kang  2453    0     0\n52                        Day Station:Lower Peirce Reservoir  2530    0     0\n57                        Day   Station:Macritchie Reservoir  2515    0     0\n62                        Day                 Station:Mandai  2526    0     0\n67                        Day          Station:Marine Parade  2532    0     0\n72                        Day         Station:Nicoll Highway  2523    0     0\n77                        Day      Station:Pasir Ris Central  2533    0     0\n82                        Day         Station:Pasir Ris West  2222    0     0\n87                        Day                Station:Punggol  2557    0     0\n92                        Day             Station:Queenstown  2552    0     0\n97                        Day              Station:Serangoon   889    0     0\n102                       Day                  Station:Simei  2435    0     0\n107                       Day          Station:Somerset Road  2542    0     0\n112                       Day         Station:Tanjong Katong  2553    0     0\n117                       Day              Station:Toa Payoh  2547    0     0\n122                       Day                   Station:Tuas  2553    0     0\n127                       Day             Station:Ulu Pandan  2478    0     0\n132                       Day Station:Upper Peirce Reservoir  2396    0     0\n137                       Day                Station:Whampoa  2494    0     0\n4                    Latitude                    Station:All 64853    0     0\n9                    Latitude         Station:Botanic Garden  1882    0     0\n14                   Latitude          Station:Bukit Panjang  2416    0     0\n19                   Latitude            Station:Bukit Timah  2541    0     0\n24                   Latitude            Station:Buona Vista  2331    0     0\n29                   Latitude  Station:Choa Chu Kang Central  2482    0     0\n34                   Latitude            Station:Jurong Pier  2497    0     0\n39                   Latitude             Station:Kent Ridge  2367    0     0\n44                   Latitude       Station:Kranji Reservoir  2507    0     0\n49                   Latitude           Station:Lim Chu Kang  2453    0     0\n54                   Latitude Station:Lower Peirce Reservoir  2530    0     0\n59                   Latitude   Station:Macritchie Reservoir  2515    0     0\n64                   Latitude                 Station:Mandai  2526    0     0\n69                   Latitude          Station:Marine Parade  2532    0     0\n74                   Latitude         Station:Nicoll Highway  2523    0     0\n79                   Latitude      Station:Pasir Ris Central  2533    0     0\n84                   Latitude         Station:Pasir Ris West  2222    0     0\n89                   Latitude                Station:Punggol  2557    0     0\n94                   Latitude             Station:Queenstown  2552    0     0\n99                   Latitude              Station:Serangoon   889    0     0\n104                  Latitude                  Station:Simei  2435    0     0\n109                  Latitude          Station:Somerset Road  2542    0     0\n114                  Latitude         Station:Tanjong Katong  2553    0     0\n119                  Latitude              Station:Toa Payoh  2547    0     0\n124                  Latitude                   Station:Tuas  2553    0     0\n129                  Latitude             Station:Ulu Pandan  2478    0     0\n134                  Latitude Station:Upper Peirce Reservoir  2396    0     0\n139                  Latitude                Station:Whampoa  2494    0     0\n5                   Longitude                    Station:All 64853    0     0\n10                  Longitude         Station:Botanic Garden  1882    0     0\n15                  Longitude          Station:Bukit Panjang  2416    0     0\n20                  Longitude            Station:Bukit Timah  2541    0     0\n25                  Longitude            Station:Buona Vista  2331    0     0\n30                  Longitude  Station:Choa Chu Kang Central  2482    0     0\n35                  Longitude            Station:Jurong Pier  2497    0     0\n40                  Longitude             Station:Kent Ridge  2367    0     0\n45                  Longitude       Station:Kranji Reservoir  2507    0     0\n50                  Longitude           Station:Lim Chu Kang  2453    0     0\n55                  Longitude Station:Lower Peirce Reservoir  2530    0     0\n60                  Longitude   Station:Macritchie Reservoir  2515    0     0\n65                  Longitude                 Station:Mandai  2526    0     0\n70                  Longitude          Station:Marine Parade  2532    0     0\n75                  Longitude         Station:Nicoll Highway  2523    0     0\n80                  Longitude      Station:Pasir Ris Central  2533    0     0\n85                  Longitude         Station:Pasir Ris West  2222    0     0\n90                  Longitude                Station:Punggol  2557    0     0\n95                  Longitude             Station:Queenstown  2552    0     0\n100                 Longitude              Station:Serangoon   889    0     0\n105                 Longitude                  Station:Simei  2435    0     0\n110                 Longitude          Station:Somerset Road  2542    0     0\n115                 Longitude         Station:Tanjong Katong  2553    0     0\n120                 Longitude              Station:Toa Payoh  2547    0     0\n125                 Longitude                   Station:Tuas  2553    0     0\n130                 Longitude             Station:Ulu Pandan  2478    0     0\n135                 Longitude Station:Upper Peirce Reservoir  2396    0     0\n140                 Longitude                Station:Whampoa  2494    0     0\n1                       Month                    Station:All 64853    0     0\n6                       Month         Station:Botanic Garden  1882    0     0\n11                      Month          Station:Bukit Panjang  2416    0     0\n16                      Month            Station:Bukit Timah  2541    0     0\n21                      Month            Station:Buona Vista  2331    0     0\n26                      Month  Station:Choa Chu Kang Central  2482    0     0\n31                      Month            Station:Jurong Pier  2497    0     0\n36                      Month             Station:Kent Ridge  2367    0     0\n41                      Month       Station:Kranji Reservoir  2507    0     0\n46                      Month           Station:Lim Chu Kang  2453    0     0\n51                      Month Station:Lower Peirce Reservoir  2530    0     0\n56                      Month   Station:Macritchie Reservoir  2515    0     0\n61                      Month                 Station:Mandai  2526    0     0\n66                      Month          Station:Marine Parade  2532    0     0\n71                      Month         Station:Nicoll Highway  2523    0     0\n76                      Month      Station:Pasir Ris Central  2533    0     0\n81                      Month         Station:Pasir Ris West  2222    0     0\n86                      Month                Station:Punggol  2557    0     0\n91                      Month             Station:Queenstown  2552    0     0\n96                      Month              Station:Serangoon   889    0     0\n101                     Month                  Station:Simei  2435    0     0\n106                     Month          Station:Somerset Road  2542    0     0\n111                     Month         Station:Tanjong Katong  2553    0     0\n116                     Month              Station:Toa Payoh  2547    0     0\n121                     Month                   Station:Tuas  2553    0     0\n126                     Month             Station:Ulu Pandan  2478    0     0\n131                     Month Station:Upper Peirce Reservoir  2396    0     0\n136                     Month                Station:Whampoa  2494    0     0\n     nPos NegInf PosInf NA_Value Per_of_Missing        sum    min    max   mean\n3   34973      0      0        0              0  464882.80   0.00 247.20   7.17\n8    1022      0      0        0              0   14731.90   0.00 160.40   7.83\n13   1391      0      0        0              0   19544.10   0.00 235.60   8.09\n18   1400      0      0        0              0   19095.80   0.00 156.80   7.52\n23   1221      0      0        0              0   16704.90   0.00 167.40   7.17\n28   1411      0      0        0              0   19461.50   0.00 144.20   7.84\n33   1398      0      0        0              0   20172.30   0.00 121.00   8.08\n38   1295      0      0        0              0   18518.60   0.00 179.60   7.82\n43   1448      0      0        0              0   19236.40   0.00 148.40   7.67\n48   1415      0      0        0              0   17674.30   0.00 111.40   7.21\n53   1449      0      0        0              0   20071.70   0.00 157.50   7.93\n58   1444      0      0        0              0   18515.30   0.00 165.60   7.36\n63   1481      0      0        0              0   19479.30   0.00 247.20   7.71\n68   1249      0      0        0              0   14786.60   0.00 195.40   5.84\n73   1302      0      0        0              0   16978.50   0.00 163.80   6.73\n78   1287      0      0        0              0   15842.70   0.00 185.80   6.25\n83   1124      0      0        0              0   12452.40   0.00 150.00   5.60\n88   1353      0      0        0              0   17390.10   0.00 168.80   6.80\n93   1353      0      0        0              0   17490.40   0.00 147.60   6.85\n98    215      0      0        0              0    3165.90   0.00  83.60   3.56\n103  1196      0      0        0              0   15604.30   0.00 182.60   6.41\n108  1351      0      0        0              0   16528.20   0.00 141.60   6.50\n113  1316      0      0        0              0   16215.50   0.00 190.60   6.35\n118  1396      0      0        0              0   18887.00   0.00 140.00   7.42\n123  1392      0      0        0              0   20559.00   0.00 134.40   8.05\n128  1375      0      0        0              0   19560.60   0.00 179.80   7.89\n133  1373      0      0        0              0   18621.90   0.00 133.20   7.77\n138  1316      0      0        0              0   17593.60   0.00 154.60   7.05\n2   64853      0      0        0              0 1020567.00   1.00  31.00  15.74\n7    1882      0      0        0              0   29570.00   1.00  31.00  15.71\n12   2416      0      0        0              0   38053.00   1.00  31.00  15.75\n17   2541      0      0        0              0   39937.00   1.00  31.00  15.72\n22   2331      0      0        0              0   36524.00   1.00  31.00  15.67\n27   2482      0      0        0              0   38856.00   1.00  31.00  15.66\n32   2497      0      0        0              0   39387.00   1.00  31.00  15.77\n37   2367      0      0        0              0   37002.00   1.00  31.00  15.63\n42   2507      0      0        0              0   39560.00   1.00  31.00  15.78\n47   2453      0      0        0              0   38528.00   1.00  31.00  15.71\n52   2530      0      0        0              0   39749.00   1.00  31.00  15.71\n57   2515      0      0        0              0   39611.00   1.00  31.00  15.75\n62   2526      0      0        0              0   39587.00   1.00  31.00  15.67\n67   2532      0      0        0              0   39982.00   1.00  31.00  15.79\n72   2523      0      0        0              0   39860.00   1.00  31.00  15.80\n77   2533      0      0        0              0   39793.00   1.00  31.00  15.71\n82   2222      0      0        0              0   34948.00   1.00  31.00  15.73\n87   2557      0      0        0              0   40224.00   1.00  31.00  15.73\n92   2552      0      0        0              0   40176.00   1.00  31.00  15.74\n97    889      0      0        0              0   14404.00   1.00  31.00  16.20\n102  2435      0      0        0              0   38172.00   1.00  31.00  15.68\n107  2542      0      0        0              0   40020.00   1.00  31.00  15.74\n112  2553      0      0        0              0   40149.00   1.00  31.00  15.73\n117  2547      0      0        0              0   40134.00   1.00  31.00  15.76\n122  2553      0      0        0              0   40168.00   1.00  31.00  15.73\n127  2478      0      0        0              0   39113.00   1.00  31.00  15.78\n132  2396      0      0        0              0   37666.00   1.00  31.00  15.72\n137  2494      0      0        0              0   39394.00   1.00  31.00  15.80\n4   64853      0      0        0              0   87212.19   1.28   1.44   1.34\n9    1882      0      0        0              0    2462.97   1.31   1.31   1.31\n14   2416      0      0        0              0    3339.64   1.38   1.38   1.38\n19   2541      0      0        0              0    3351.83   1.32   1.32   1.32\n24   2331      0      0        0              0    2993.24   1.28   1.28   1.28\n29   2482      0      0        0              0    3430.37   1.38   1.38   1.38\n34   2497      0      0        0              0    3266.58   1.31   1.31   1.31\n39   2367      0      0        0              0    3058.87   1.29   1.29   1.29\n44   2507      0      0        0              0    3606.82   1.44   1.44   1.44\n49   2453      0      0        0              0    3529.38   1.44   1.44   1.44\n54   2530      0      0        0              0    3466.10   1.37   1.37   1.37\n59   2515      0      0        0              0    3374.63   1.34   1.34   1.34\n64   2526      0      0        0              0    3553.32   1.41   1.41   1.41\n69   2532      0      0        0              0    3304.26   1.30   1.30   1.30\n74   2523      0      0        0              0    3267.28   1.29   1.29   1.29\n79   2533      0      0        0              0    3464.89   1.37   1.37   1.37\n84   2222      0      0        0              0    3080.80   1.39   1.39   1.39\n89   2557      0      0        0              0    3586.96   1.40   1.40   1.40\n94   2552      0      0        0              0    3301.52   1.29   1.29   1.29\n99    889      0      0        0              0    1189.22   1.34   1.34   1.34\n104  2435      0      0        0              0    3273.37   1.34   1.34   1.34\n109  2542      0      0        0              0    3305.36   1.30   1.30   1.30\n114  2553      0      0        0              0    3336.77   1.31   1.31   1.31\n119  2547      0      0        0              0    3417.31   1.34   1.34   1.34\n124  2553      0      0        0              0    3369.70   1.32   1.32   1.32\n129  2478      0      0        0              0    3301.94   1.33   1.33   1.33\n134  2396      0      0        0              0    3283.48   1.37   1.37   1.37\n139  2494      0      0        0              0    3295.57   1.32   1.32   1.32\n5   64853      0      0        0              0 6732989.28 103.66 103.95 103.82\n10   1882      0      0        0              0  195385.48 103.82 103.82 103.82\n15   2416      0      0        0              0  250685.85 103.76 103.76 103.76\n20   2541      0      0        0              0  263804.84 103.82 103.82 103.82\n25   2331      0      0        0              0  241931.69 103.79 103.79 103.79\n30   2482      0      0        0              0  257477.96 103.74 103.74 103.74\n35   2497      0      0        0              0  258963.87 103.71 103.71 103.71\n40   2367      0      0        0              0  245650.81 103.78 103.78 103.78\n45   2507      0      0        0              0  260066.15 103.74 103.74 103.74\n50   2453      0      0        0              0  254380.27 103.70 103.70 103.70\n55   2530      0      0        0              0  262682.56 103.83 103.83 103.83\n60   2515      0      0        0              0  261142.26 103.83 103.83 103.83\n65   2526      0      0        0              0  262156.36 103.78 103.78 103.78\n70   2532      0      0        0              0  263103.16 103.91 103.91 103.91\n75   2523      0      0        0              0  262044.33 103.86 103.86 103.86\n80   2533      0      0        0              0  263302.56 103.95 103.95 103.95\n85   2222      0      0        0              0  230957.57 103.94 103.94 103.94\n90   2557      0      0        0              0  265696.59 103.91 103.91 103.91\n95   2552      0      0        0              0  264930.01 103.81 103.81 103.81\n100   889      0      0        0              0   92337.05 103.87 103.87 103.87\n105  2435      0      0        0              0  253103.88 103.94 103.94 103.94\n110  2542      0      0        0              0  263954.16 103.84 103.84 103.84\n115  2553      0      0        0              0  265232.96 103.89 103.89 103.89\n120  2547      0      0        0              0  264509.77 103.85 103.85 103.85\n125  2553      0      0        0              0  264647.30 103.66 103.66 103.66\n130  2478      0      0        0              0  257104.89 103.75 103.75 103.75\n135  2396      0      0        0              0  248715.82 103.80 103.80 103.80\n140  2494      0      0        0              0  259021.10 103.86 103.86 103.86\n1   64853      0      0        0              0  422448.00   1.00  12.00   6.51\n6    1882      0      0        0              0   11969.00   1.00  12.00   6.36\n11   2416      0      0        0              0   16141.00   1.00  12.00   6.68\n16   2541      0      0        0              0   16612.00   1.00  12.00   6.54\n21   2331      0      0        0              0   14754.00   1.00  12.00   6.33\n26   2482      0      0        0              0   15956.00   1.00  12.00   6.43\n31   2497      0      0        0              0   16375.00   1.00  12.00   6.56\n36   2367      0      0        0              0   15783.00   1.00  12.00   6.67\n41   2507      0      0        0              0   16322.00   1.00  12.00   6.51\n46   2453      0      0        0              0   15916.00   1.00  12.00   6.49\n51   2530      0      0        0              0   16513.00   1.00  12.00   6.53\n56   2515      0      0        0              0   16478.00   1.00  12.00   6.55\n61   2526      0      0        0              0   16479.00   1.00  12.00   6.52\n66   2532      0      0        0              0   16494.00   1.00  12.00   6.51\n71   2523      0      0        0              0   16427.00   1.00  12.00   6.51\n76   2533      0      0        0              0   16415.00   1.00  12.00   6.48\n81   2222      0      0        0              0   14462.00   1.00  12.00   6.51\n86   2557      0      0        0              0   16678.00   1.00  12.00   6.52\n91   2552      0      0        0              0   16635.00   1.00  12.00   6.52\n96    889      0      0        0              0    5219.00   1.00  12.00   5.87\n101  2435      0      0        0              0   16109.00   1.00  12.00   6.62\n106  2542      0      0        0              0   16643.00   1.00  12.00   6.55\n111  2553      0      0        0              0   16661.00   1.00  12.00   6.53\n116  2547      0      0        0              0   16594.00   1.00  12.00   6.52\n121  2553      0      0        0              0   16643.00   1.00  12.00   6.52\n126  2478      0      0        0              0   16323.00   1.00  12.00   6.59\n131  2396      0      0        0              0   15771.00   1.00  12.00   6.58\n136  2494      0      0        0              0   16076.00   1.00  12.00   6.45\n    median    SD   CV   IQR Skewness Kurtosis\n3     0.20 14.91 2.08  7.20     3.63    19.51\n8     0.20 15.90 2.03  8.40     3.27    14.37\n13    0.60 16.15 2.00  9.00     3.97    27.17\n18    0.40 14.84 1.97  8.40     3.31    15.33\n23    0.20 15.55 2.17  6.70     3.77    19.49\n28    0.40 15.39 1.96  9.00     3.29    14.76\n33    0.40 15.63 1.93  9.00     2.94    10.39\n38    0.40 16.52 2.11  7.60     3.68    18.84\n43    0.60 14.98 1.95  8.20     3.13    13.32\n48    0.40 14.13 1.96  7.80     3.07    11.67\n53    0.40 15.68 1.98  8.80     3.26    14.42\n58    0.40 14.74 2.00  7.60     3.40    16.45\n63    0.50 15.78 2.05  8.40     4.11    30.95\n68    0.00 13.68 2.34  5.20     4.82    37.56\n73    0.20 14.66 2.18  6.00     3.70    18.88\n78    0.20 14.06 2.25  5.80     4.42    31.56\n83    0.20 12.43 2.22  5.00     3.70    19.27\n88    0.20 14.26 2.10  7.00     3.88    22.77\n93    0.20 14.38 2.10  6.40     3.50    16.40\n98    0.00 10.40 2.92  0.00     4.01    18.22\n103   0.00 14.82 2.31  5.60     4.45    30.06\n108   0.20 13.50 2.08  6.35     3.36    15.21\n113   0.20 14.21 2.24  5.40     4.43    31.43\n118   0.40 15.04 2.03  7.60     3.39    15.14\n123   0.40 16.24 2.02  8.20     3.25    13.40\n128   0.40 16.01 2.03  8.20     3.59    19.16\n133   0.40 15.01 1.93  8.60     3.03    11.55\n138   0.20 14.43 2.05  7.20     3.36    15.43\n2    16.00  8.81 0.56 15.00     0.01    -1.20\n7    16.00  8.80 0.56 15.00     0.01    -1.20\n12   16.00  8.79 0.56 15.00     0.00    -1.19\n17   16.00  8.81 0.56 15.00     0.01    -1.20\n22   16.00  8.80 0.56 15.00     0.01    -1.19\n27   16.00  8.80 0.56 15.00     0.02    -1.19\n32   16.00  8.81 0.56 15.00     0.00    -1.20\n37   16.00  8.84 0.57 15.00     0.02    -1.20\n42   16.00  8.79 0.56 15.00     0.00    -1.19\n47   16.00  8.82 0.56 15.00     0.01    -1.20\n52   16.00  8.82 0.56 15.00     0.01    -1.20\n57   16.00  8.78 0.56 15.00     0.00    -1.19\n62   16.00  8.80 0.56 15.00     0.02    -1.19\n67   16.00  8.80 0.56 15.00    -0.01    -1.19\n72   16.00  8.82 0.56 15.00    -0.01    -1.20\n77   16.00  8.80 0.56 15.00     0.01    -1.20\n82   16.00  8.81 0.56 15.00     0.01    -1.20\n87   16.00  8.80 0.56 15.00     0.01    -1.19\n92   16.00  8.81 0.56 15.00     0.00    -1.20\n97   16.00  9.02 0.56 17.00    -0.06    -1.27\n102  16.00  8.81 0.56 15.00     0.01    -1.19\n107  16.00  8.78 0.56 15.00     0.00    -1.19\n112  16.00  8.80 0.56 15.00     0.01    -1.20\n117  16.00  8.81 0.56 15.00     0.00    -1.19\n122  16.00  8.81 0.56 15.00     0.01    -1.20\n127  16.00  8.80 0.56 15.00     0.00    -1.19\n132  16.00  8.79 0.56 15.00     0.01    -1.20\n137  16.00  8.78 0.56 15.00    -0.01    -1.19\n4     1.34  0.04 0.03  0.08     0.59    -0.71\n9     1.31  0.00 0.00  0.00      NaN      NaN\n14    1.38  0.00 0.00  0.00      NaN      NaN\n19    1.32  0.00 0.00  0.00      NaN      NaN\n24    1.28  0.00 0.00  0.00      NaN      NaN\n29    1.38  0.00 0.00  0.00      NaN      NaN\n34    1.31  0.00 0.00  0.00      NaN      NaN\n39    1.29  0.00 0.00  0.00      NaN      NaN\n44    1.44  0.00 0.00  0.00      NaN      NaN\n49    1.44  0.00 0.00  0.00      NaN      NaN\n54    1.37  0.00 0.00  0.00      NaN      NaN\n59    1.34  0.00 0.00  0.00      NaN      NaN\n64    1.41  0.00 0.00  0.00      NaN      NaN\n69    1.30  0.00 0.00  0.00      NaN      NaN\n74    1.29  0.00 0.00  0.00      NaN      NaN\n79    1.37  0.00 0.00  0.00      NaN      NaN\n84    1.39  0.00 0.00  0.00      NaN      NaN\n89    1.40  0.00 0.00  0.00      NaN      NaN\n94    1.29  0.00 0.00  0.00      NaN      NaN\n99    1.34  0.00 0.00  0.00      NaN      NaN\n104   1.34  0.00 0.00  0.00      NaN      NaN\n109   1.30  0.00 0.00  0.00      NaN      NaN\n114   1.31  0.00 0.00  0.00      NaN      NaN\n119   1.34  0.00 0.00  0.00      NaN      NaN\n124   1.32  0.00 0.00  0.00      NaN      NaN\n129   1.33  0.00 0.00  0.00      NaN      NaN\n134   1.37  0.00 0.00  0.00      NaN      NaN\n139   1.32  0.00 0.00  0.00      NaN      NaN\n5   103.82  0.08 0.00  0.10    -0.07    -0.68\n10  103.82  0.00 0.00  0.00      NaN      NaN\n15  103.76  0.00 0.00  0.00      NaN      NaN\n20  103.82  0.00 0.00  0.00      NaN      NaN\n25  103.79  0.00 0.00  0.00      NaN      NaN\n30  103.74  0.00 0.00  0.00      NaN      NaN\n35  103.71  0.00 0.00  0.00      NaN      NaN\n40  103.78  0.00 0.00  0.00      NaN      NaN\n45  103.74  0.00 0.00  0.00      NaN      NaN\n50  103.70  0.00 0.00  0.00      NaN      NaN\n55  103.83  0.00 0.00  0.00      NaN      NaN\n60  103.83  0.00 0.00  0.00      NaN      NaN\n65  103.78  0.00 0.00  0.00      NaN      NaN\n70  103.91  0.00 0.00  0.00      NaN      NaN\n75  103.86  0.00 0.00  0.00      NaN      NaN\n80  103.95  0.00 0.00  0.00      NaN      NaN\n85  103.94  0.00 0.00  0.00      NaN      NaN\n90  103.91  0.00 0.00  0.00      NaN      NaN\n95  103.81  0.00 0.00  0.00      NaN      NaN\n100 103.87  0.00 0.00  0.00      NaN      NaN\n105 103.94  0.00 0.00  0.00      NaN      NaN\n110 103.84  0.00 0.00  0.00      NaN      NaN\n115 103.89  0.00 0.00  0.00      NaN      NaN\n120 103.85  0.00 0.00  0.00      NaN      NaN\n125 103.66  0.00 0.00  0.00      NaN      NaN\n130 103.75  0.00 0.00  0.00      NaN      NaN\n135 103.80  0.00 0.00  0.00      NaN      NaN\n140 103.86  0.00 0.00  0.00      NaN      NaN\n1     7.00  3.45 0.53  6.00    -0.01    -1.21\n6     6.00  3.51 0.55  6.00     0.03    -1.24\n11    7.00  3.47 0.52  6.00    -0.10    -1.19\n16    7.00  3.44 0.53  6.00    -0.01    -1.20\n21    6.00  3.40 0.54  6.00     0.08    -1.17\n26    6.00  3.42 0.53  6.00     0.00    -1.20\n31    7.00  3.44 0.53  6.00    -0.02    -1.20\n36    7.00  3.40 0.51  6.00    -0.08    -1.16\n41    7.00  3.45 0.53  6.00     0.00    -1.21\n46    7.00  3.46 0.53  6.00     0.00    -1.22\n51    7.00  3.44 0.53  6.00     0.00    -1.20\n56    7.00  3.44 0.52  6.00    -0.02    -1.21\n61    7.00  3.44 0.53  5.75    -0.01    -1.21\n66    7.00  3.46 0.53  6.00     0.00    -1.22\n71    7.00  3.43 0.53  5.00     0.00    -1.20\n76    6.00  3.44 0.53  5.00     0.00    -1.20\n81    6.00  3.54 0.54  7.00     0.02    -1.27\n86    7.00  3.45 0.53  6.00    -0.01    -1.21\n91    7.00  3.45 0.53  6.00    -0.01    -1.21\n96    6.00  3.42 0.58  6.00     0.16    -1.22\n101   7.00  3.42 0.52  6.00    -0.06    -1.19\n106   7.00  3.44 0.53  6.00    -0.02    -1.20\n111   7.00  3.45 0.53  6.00    -0.01    -1.21\n116   7.00  3.45 0.53  6.00     0.00    -1.21\n121   7.00  3.45 0.53  6.00    -0.01    -1.21\n126   7.00  3.44 0.52  6.00    -0.03    -1.21\n131   7.00  3.48 0.53  7.00    -0.04    -1.23\n136   6.00  3.42 0.53  6.00     0.03    -1.18\n```\n\n\n:::\n:::\n\n\n\n# 4. Temporal Rainfall Analysis\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create monthly time series object\nmonthly_station_rain <- weather_active %>%\n  mutate(MonthYear = floor_date(Date, \"month\")) %>%\n  group_by(Station, MonthYear) %>%\n  summarise(MonthlyRain = sum(Daily.Rainfall.Total..mm.))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmonthly_station_rain <- monthly_station_rain %>%\n  mutate(MonthYear = yearmonth(MonthYear)) %>%\n  as_tsibble(index = MonthYear, key = Station)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmonthly_station_rain\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 2,213 x 3 [1M]\n# Key:       Station [27]\n# Groups:    Station [27]\n   Station        MonthYear MonthlyRain\n   <fct>              <mth>       <dbl>\n 1 Botanic Garden  2018 Jan       404. \n 2 Botanic Garden  2018 Feb        22.2\n 3 Botanic Garden  2018 Mar       222  \n 4 Botanic Garden  2018 Apr       229. \n 5 Botanic Garden  2018 May       219  \n 6 Botanic Garden  2018 Jun       296. \n 7 Botanic Garden  2018 Jul        95.2\n 8 Botanic Garden  2018 Aug       120. \n 9 Botanic Garden  2018 Sep       227. \n10 Botanic Garden  2018 Oct       200. \n# â„¹ 2,203 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nseasonal_rain <- monthly_station_rain %>%\n  fill_gaps() %>%\n  group_by(Station) %>%\n  mutate(MonthlyRain = na_interpolation(MonthlyRain)) %>%\n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nts_decomposition <- function(station_name) {\n  seasonal_rain %>%\n    filter(Station == station_name) %>%\n    gg_tsdisplay(MonthlyRain) +\n    labs(title = paste(\"Monthly Rainfall in\", station_name))\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nts_decomposition(\"Bukit Panjang\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstl_decomposition <- function(station_name) {\n  seasonal_rain %>%\n    filter(Station == station_name) %>%\n    model(stl = STL(MonthlyRain)) %>%\n    components() %>%\n    autoplot() +\n    labs(title = paste(\"STL Decomposition for\", station_name))\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstl_decomposition(\"Bukit Panjang\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstl_residuals <- function(station_name) {\n  model_fit <- seasonal_rain %>%\n    filter(Station == station_name) %>%\n    model(ETS(MonthlyRain))\n  \n  gg_tsresiduals(model_fit) +\n    labs(title = paste(\"Residuals Components for\", station_name))\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstl_residuals(\"Bukit Panjang\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndetect_changepoints <- function(station_name) {\n  station_data <- seasonal_rain %>%\n    filter(Station == station_name) %>%\n    pull(MonthlyRain)\n\n  cpt_result <- cpt.mean(station_data, method = \"PELT\")\n  \n  plot(\n    cpt_result,\n    main = paste(\"Change Points in Monthly Rainfall (Mean) for\", station_name),\n    xlab = \"Month Index\",\n    ylab = \"Rainfall (mm)\"\n  )\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nchangepoint_res <- detect_changepoints(\"Bukit Panjang\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_changepoints <- function(station_name) {\n  station_data <- seasonal_rain %>%\n    filter(Station == station_name)\n  \n  rain <- station_data$MonthlyRain\n  dates <- station_data$MonthYear\n  \n  cpt_result <- cpt.mean(rain, method = \"PELT\")\n  change_indices <- cpts(cpt_result)\n  change_dates <- as.Date(dates[change_indices])\n  \n  ggplot(station_data, aes(x = as.Date(MonthYear), y = MonthlyRain)) +\n    geom_line(color = \"steelblue\") +\n    geom_vline(xintercept = change_dates, linetype = \"dashed\", color = \"red\") +\n    labs(\n      title = paste(\"Monthly Rainfall with Change Points for\", station_name),\n      x = \"Year\",\n      y = \"Rainfall (mm)\"\n    ) +\n    theme_minimal()\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_changepoints(\"Bukit Panjang\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Take-home_Ex03_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}