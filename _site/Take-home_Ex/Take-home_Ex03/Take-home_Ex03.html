<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Wong Zi Qi">
<meta name="dcterms.date" content="2025-03-24">

<title>Take-home Exercise 3: Spatiotemporal Rainfall Analysis â€“ ISSS608-VAA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608-VAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07.html">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09.html">
 <span class="dropdown-text">In-class Exercise 9</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex03.html">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">1. Getting Started</a></li>
  <li><a href="#data-pre-processing" id="toc-data-pre-processing" class="nav-link" data-scroll-target="#data-pre-processing">2. Data Pre-processing</a></li>
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda">3. EDA</a></li>
  <li><a href="#temporal-rainfall-analysis" id="toc-temporal-rainfall-analysis" class="nav-link" data-scroll-target="#temporal-rainfall-analysis">4. Temporal Rainfall Analysis</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 3: Spatiotemporal Rainfall Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Wong Zi Qi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 24, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 24, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="overview" class="level1">
<h1>Overview</h1>
</section>
<section id="getting-started" class="level1">
<h1>1. Getting Started</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, lubridate, SmartEDA, ggplot2, tsibble, feasts, seasonal,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               imputeTS, fable, changepoint)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>weather <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/weather_data.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>active_stations <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/active_rainfall_stations.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-pre-processing" class="level1">
<h1>2. Data Pre-processing</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove () for consistent naming</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>weather<span class="sc">$</span>Station <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[()]"</span>, <span class="st">""</span>, <span class="fu">trimws</span>(<span class="fu">as.character</span>(weather<span class="sc">$</span>Station)))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>active_stations<span class="sc">$</span>Station.Name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[()]"</span>, <span class="st">""</span>, <span class="fu">trimws</span>(<span class="fu">as.character</span>(active_stations<span class="sc">$</span>Station.Name)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that both active stations and weather data have consistent naming, with 27 distinct values, we filter stations that are active.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>weather_active <span class="ot">&lt;-</span> weather <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Station <span class="sc">%in%</span> active_stations<span class="sc">$</span>Station.Name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>weather_active <span class="ot">&lt;-</span> weather_active <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Station, Year, Month, Day, Daily.Rainfall.Total..mm.) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Daily.Rainfall.Total..mm.)) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(active_stations, <span class="at">by.x =</span> <span class="st">"Station"</span>, <span class="at">by.y =</span> <span class="st">"Station.Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Station, Year, Month, Day, Daily.Rainfall.Total..mm., Latitude, Longitude) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">make_date</span>(Year, Month, Day), <span class="at">Station =</span> <span class="fu">as.factor</span>(Station)) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Station, Date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="eda" class="level1">
<h1>3. EDA</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>weather_active <span class="sc">%&gt;%</span> <span class="fu">ExpData</span>(<span class="at">type =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                          Descriptions    Value
1                                   Sample size (nrow)    64853
2                              No. of variables (ncol)        8
3                    No. of numeric/interger variables        6
4                              No. of factor variables        1
5                                No. of text variables        0
6                             No. of logical variables        0
7                          No. of identifier variables        0
8                                No. of date variables        1
9             No. of zero variance variables (uniform)        0
10               %. of variables having complete cases 100% (8)
11   %. of variables having &gt;0% and &lt;50% missing cases   0% (0)
12 %. of variables having &gt;=50% and &lt;90% missing cases   0% (0)
13          %. of variables having &gt;=90% missing cases   0% (0)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>weather_active <span class="sc">%&gt;%</span> <span class="fu">ExpData</span>(<span class="at">type =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Index             Variable_Name Variable_Type Sample_n Missing_Count
1     1                   Station        factor    64853             0
2     2                      Year       numeric    64853             0
3     3                     Month       numeric    64853             0
4     4                       Day       numeric    64853             0
5     5 Daily.Rainfall.Total..mm.       numeric    64853             0
6     6                  Latitude       numeric    64853             0
7     7                 Longitude       numeric    64853             0
8     8                      Date          Date    64853             0
  Per_of_Missing No_of_distinct_values
1              0                    27
2              0                     7
3              0                    12
4              0                    31
5              0                   679
6              0                    27
7              0                    27
8              0                  2557</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explore how rainfall varies across stations</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpNumStat</span>(weather_active, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">by =</span> <span class="st">"GA"</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">gp =</span> <span class="st">"Station"</span>, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">round =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Vname                          Group    TN nNeg nZero
3   Daily.Rainfall.Total..mm.                    Station:All 64853    0 29880
8   Daily.Rainfall.Total..mm.         Station:Botanic Garden  1882    0   860
13  Daily.Rainfall.Total..mm.          Station:Bukit Panjang  2416    0  1025
18  Daily.Rainfall.Total..mm.            Station:Bukit Timah  2541    0  1141
23  Daily.Rainfall.Total..mm.            Station:Buona Vista  2331    0  1110
28  Daily.Rainfall.Total..mm.  Station:Choa Chu Kang Central  2482    0  1071
33  Daily.Rainfall.Total..mm.            Station:Jurong Pier  2497    0  1099
38  Daily.Rainfall.Total..mm.             Station:Kent Ridge  2367    0  1072
43  Daily.Rainfall.Total..mm.       Station:Kranji Reservoir  2507    0  1059
48  Daily.Rainfall.Total..mm.           Station:Lim Chu Kang  2453    0  1038
53  Daily.Rainfall.Total..mm. Station:Lower Peirce Reservoir  2530    0  1081
58  Daily.Rainfall.Total..mm.   Station:Macritchie Reservoir  2515    0  1071
63  Daily.Rainfall.Total..mm.                 Station:Mandai  2526    0  1045
68  Daily.Rainfall.Total..mm.          Station:Marine Parade  2532    0  1283
73  Daily.Rainfall.Total..mm.         Station:Nicoll Highway  2523    0  1221
78  Daily.Rainfall.Total..mm.      Station:Pasir Ris Central  2533    0  1246
83  Daily.Rainfall.Total..mm.         Station:Pasir Ris West  2222    0  1098
88  Daily.Rainfall.Total..mm.                Station:Punggol  2557    0  1204
93  Daily.Rainfall.Total..mm.             Station:Queenstown  2552    0  1199
98  Daily.Rainfall.Total..mm.              Station:Serangoon   889    0   674
103 Daily.Rainfall.Total..mm.                  Station:Simei  2435    0  1239
108 Daily.Rainfall.Total..mm.          Station:Somerset Road  2542    0  1191
113 Daily.Rainfall.Total..mm.         Station:Tanjong Katong  2553    0  1237
118 Daily.Rainfall.Total..mm.              Station:Toa Payoh  2547    0  1151
123 Daily.Rainfall.Total..mm.                   Station:Tuas  2553    0  1161
128 Daily.Rainfall.Total..mm.             Station:Ulu Pandan  2478    0  1103
133 Daily.Rainfall.Total..mm. Station:Upper Peirce Reservoir  2396    0  1023
138 Daily.Rainfall.Total..mm.                Station:Whampoa  2494    0  1178
2                         Day                    Station:All 64853    0     0
7                         Day         Station:Botanic Garden  1882    0     0
12                        Day          Station:Bukit Panjang  2416    0     0
17                        Day            Station:Bukit Timah  2541    0     0
22                        Day            Station:Buona Vista  2331    0     0
27                        Day  Station:Choa Chu Kang Central  2482    0     0
32                        Day            Station:Jurong Pier  2497    0     0
37                        Day             Station:Kent Ridge  2367    0     0
42                        Day       Station:Kranji Reservoir  2507    0     0
47                        Day           Station:Lim Chu Kang  2453    0     0
52                        Day Station:Lower Peirce Reservoir  2530    0     0
57                        Day   Station:Macritchie Reservoir  2515    0     0
62                        Day                 Station:Mandai  2526    0     0
67                        Day          Station:Marine Parade  2532    0     0
72                        Day         Station:Nicoll Highway  2523    0     0
77                        Day      Station:Pasir Ris Central  2533    0     0
82                        Day         Station:Pasir Ris West  2222    0     0
87                        Day                Station:Punggol  2557    0     0
92                        Day             Station:Queenstown  2552    0     0
97                        Day              Station:Serangoon   889    0     0
102                       Day                  Station:Simei  2435    0     0
107                       Day          Station:Somerset Road  2542    0     0
112                       Day         Station:Tanjong Katong  2553    0     0
117                       Day              Station:Toa Payoh  2547    0     0
122                       Day                   Station:Tuas  2553    0     0
127                       Day             Station:Ulu Pandan  2478    0     0
132                       Day Station:Upper Peirce Reservoir  2396    0     0
137                       Day                Station:Whampoa  2494    0     0
4                    Latitude                    Station:All 64853    0     0
9                    Latitude         Station:Botanic Garden  1882    0     0
14                   Latitude          Station:Bukit Panjang  2416    0     0
19                   Latitude            Station:Bukit Timah  2541    0     0
24                   Latitude            Station:Buona Vista  2331    0     0
29                   Latitude  Station:Choa Chu Kang Central  2482    0     0
34                   Latitude            Station:Jurong Pier  2497    0     0
39                   Latitude             Station:Kent Ridge  2367    0     0
44                   Latitude       Station:Kranji Reservoir  2507    0     0
49                   Latitude           Station:Lim Chu Kang  2453    0     0
54                   Latitude Station:Lower Peirce Reservoir  2530    0     0
59                   Latitude   Station:Macritchie Reservoir  2515    0     0
64                   Latitude                 Station:Mandai  2526    0     0
69                   Latitude          Station:Marine Parade  2532    0     0
74                   Latitude         Station:Nicoll Highway  2523    0     0
79                   Latitude      Station:Pasir Ris Central  2533    0     0
84                   Latitude         Station:Pasir Ris West  2222    0     0
89                   Latitude                Station:Punggol  2557    0     0
94                   Latitude             Station:Queenstown  2552    0     0
99                   Latitude              Station:Serangoon   889    0     0
104                  Latitude                  Station:Simei  2435    0     0
109                  Latitude          Station:Somerset Road  2542    0     0
114                  Latitude         Station:Tanjong Katong  2553    0     0
119                  Latitude              Station:Toa Payoh  2547    0     0
124                  Latitude                   Station:Tuas  2553    0     0
129                  Latitude             Station:Ulu Pandan  2478    0     0
134                  Latitude Station:Upper Peirce Reservoir  2396    0     0
139                  Latitude                Station:Whampoa  2494    0     0
5                   Longitude                    Station:All 64853    0     0
10                  Longitude         Station:Botanic Garden  1882    0     0
15                  Longitude          Station:Bukit Panjang  2416    0     0
20                  Longitude            Station:Bukit Timah  2541    0     0
25                  Longitude            Station:Buona Vista  2331    0     0
30                  Longitude  Station:Choa Chu Kang Central  2482    0     0
35                  Longitude            Station:Jurong Pier  2497    0     0
40                  Longitude             Station:Kent Ridge  2367    0     0
45                  Longitude       Station:Kranji Reservoir  2507    0     0
50                  Longitude           Station:Lim Chu Kang  2453    0     0
55                  Longitude Station:Lower Peirce Reservoir  2530    0     0
60                  Longitude   Station:Macritchie Reservoir  2515    0     0
65                  Longitude                 Station:Mandai  2526    0     0
70                  Longitude          Station:Marine Parade  2532    0     0
75                  Longitude         Station:Nicoll Highway  2523    0     0
80                  Longitude      Station:Pasir Ris Central  2533    0     0
85                  Longitude         Station:Pasir Ris West  2222    0     0
90                  Longitude                Station:Punggol  2557    0     0
95                  Longitude             Station:Queenstown  2552    0     0
100                 Longitude              Station:Serangoon   889    0     0
105                 Longitude                  Station:Simei  2435    0     0
110                 Longitude          Station:Somerset Road  2542    0     0
115                 Longitude         Station:Tanjong Katong  2553    0     0
120                 Longitude              Station:Toa Payoh  2547    0     0
125                 Longitude                   Station:Tuas  2553    0     0
130                 Longitude             Station:Ulu Pandan  2478    0     0
135                 Longitude Station:Upper Peirce Reservoir  2396    0     0
140                 Longitude                Station:Whampoa  2494    0     0
1                       Month                    Station:All 64853    0     0
6                       Month         Station:Botanic Garden  1882    0     0
11                      Month          Station:Bukit Panjang  2416    0     0
16                      Month            Station:Bukit Timah  2541    0     0
21                      Month            Station:Buona Vista  2331    0     0
26                      Month  Station:Choa Chu Kang Central  2482    0     0
31                      Month            Station:Jurong Pier  2497    0     0
36                      Month             Station:Kent Ridge  2367    0     0
41                      Month       Station:Kranji Reservoir  2507    0     0
46                      Month           Station:Lim Chu Kang  2453    0     0
51                      Month Station:Lower Peirce Reservoir  2530    0     0
56                      Month   Station:Macritchie Reservoir  2515    0     0
61                      Month                 Station:Mandai  2526    0     0
66                      Month          Station:Marine Parade  2532    0     0
71                      Month         Station:Nicoll Highway  2523    0     0
76                      Month      Station:Pasir Ris Central  2533    0     0
81                      Month         Station:Pasir Ris West  2222    0     0
86                      Month                Station:Punggol  2557    0     0
91                      Month             Station:Queenstown  2552    0     0
96                      Month              Station:Serangoon   889    0     0
101                     Month                  Station:Simei  2435    0     0
106                     Month          Station:Somerset Road  2542    0     0
111                     Month         Station:Tanjong Katong  2553    0     0
116                     Month              Station:Toa Payoh  2547    0     0
121                     Month                   Station:Tuas  2553    0     0
126                     Month             Station:Ulu Pandan  2478    0     0
131                     Month Station:Upper Peirce Reservoir  2396    0     0
136                     Month                Station:Whampoa  2494    0     0
     nPos NegInf PosInf NA_Value Per_of_Missing        sum    min    max   mean
3   34973      0      0        0              0  464882.80   0.00 247.20   7.17
8    1022      0      0        0              0   14731.90   0.00 160.40   7.83
13   1391      0      0        0              0   19544.10   0.00 235.60   8.09
18   1400      0      0        0              0   19095.80   0.00 156.80   7.52
23   1221      0      0        0              0   16704.90   0.00 167.40   7.17
28   1411      0      0        0              0   19461.50   0.00 144.20   7.84
33   1398      0      0        0              0   20172.30   0.00 121.00   8.08
38   1295      0      0        0              0   18518.60   0.00 179.60   7.82
43   1448      0      0        0              0   19236.40   0.00 148.40   7.67
48   1415      0      0        0              0   17674.30   0.00 111.40   7.21
53   1449      0      0        0              0   20071.70   0.00 157.50   7.93
58   1444      0      0        0              0   18515.30   0.00 165.60   7.36
63   1481      0      0        0              0   19479.30   0.00 247.20   7.71
68   1249      0      0        0              0   14786.60   0.00 195.40   5.84
73   1302      0      0        0              0   16978.50   0.00 163.80   6.73
78   1287      0      0        0              0   15842.70   0.00 185.80   6.25
83   1124      0      0        0              0   12452.40   0.00 150.00   5.60
88   1353      0      0        0              0   17390.10   0.00 168.80   6.80
93   1353      0      0        0              0   17490.40   0.00 147.60   6.85
98    215      0      0        0              0    3165.90   0.00  83.60   3.56
103  1196      0      0        0              0   15604.30   0.00 182.60   6.41
108  1351      0      0        0              0   16528.20   0.00 141.60   6.50
113  1316      0      0        0              0   16215.50   0.00 190.60   6.35
118  1396      0      0        0              0   18887.00   0.00 140.00   7.42
123  1392      0      0        0              0   20559.00   0.00 134.40   8.05
128  1375      0      0        0              0   19560.60   0.00 179.80   7.89
133  1373      0      0        0              0   18621.90   0.00 133.20   7.77
138  1316      0      0        0              0   17593.60   0.00 154.60   7.05
2   64853      0      0        0              0 1020567.00   1.00  31.00  15.74
7    1882      0      0        0              0   29570.00   1.00  31.00  15.71
12   2416      0      0        0              0   38053.00   1.00  31.00  15.75
17   2541      0      0        0              0   39937.00   1.00  31.00  15.72
22   2331      0      0        0              0   36524.00   1.00  31.00  15.67
27   2482      0      0        0              0   38856.00   1.00  31.00  15.66
32   2497      0      0        0              0   39387.00   1.00  31.00  15.77
37   2367      0      0        0              0   37002.00   1.00  31.00  15.63
42   2507      0      0        0              0   39560.00   1.00  31.00  15.78
47   2453      0      0        0              0   38528.00   1.00  31.00  15.71
52   2530      0      0        0              0   39749.00   1.00  31.00  15.71
57   2515      0      0        0              0   39611.00   1.00  31.00  15.75
62   2526      0      0        0              0   39587.00   1.00  31.00  15.67
67   2532      0      0        0              0   39982.00   1.00  31.00  15.79
72   2523      0      0        0              0   39860.00   1.00  31.00  15.80
77   2533      0      0        0              0   39793.00   1.00  31.00  15.71
82   2222      0      0        0              0   34948.00   1.00  31.00  15.73
87   2557      0      0        0              0   40224.00   1.00  31.00  15.73
92   2552      0      0        0              0   40176.00   1.00  31.00  15.74
97    889      0      0        0              0   14404.00   1.00  31.00  16.20
102  2435      0      0        0              0   38172.00   1.00  31.00  15.68
107  2542      0      0        0              0   40020.00   1.00  31.00  15.74
112  2553      0      0        0              0   40149.00   1.00  31.00  15.73
117  2547      0      0        0              0   40134.00   1.00  31.00  15.76
122  2553      0      0        0              0   40168.00   1.00  31.00  15.73
127  2478      0      0        0              0   39113.00   1.00  31.00  15.78
132  2396      0      0        0              0   37666.00   1.00  31.00  15.72
137  2494      0      0        0              0   39394.00   1.00  31.00  15.80
4   64853      0      0        0              0   87212.19   1.28   1.44   1.34
9    1882      0      0        0              0    2462.97   1.31   1.31   1.31
14   2416      0      0        0              0    3339.64   1.38   1.38   1.38
19   2541      0      0        0              0    3351.83   1.32   1.32   1.32
24   2331      0      0        0              0    2993.24   1.28   1.28   1.28
29   2482      0      0        0              0    3430.37   1.38   1.38   1.38
34   2497      0      0        0              0    3266.58   1.31   1.31   1.31
39   2367      0      0        0              0    3058.87   1.29   1.29   1.29
44   2507      0      0        0              0    3606.82   1.44   1.44   1.44
49   2453      0      0        0              0    3529.38   1.44   1.44   1.44
54   2530      0      0        0              0    3466.10   1.37   1.37   1.37
59   2515      0      0        0              0    3374.63   1.34   1.34   1.34
64   2526      0      0        0              0    3553.32   1.41   1.41   1.41
69   2532      0      0        0              0    3304.26   1.30   1.30   1.30
74   2523      0      0        0              0    3267.28   1.29   1.29   1.29
79   2533      0      0        0              0    3464.89   1.37   1.37   1.37
84   2222      0      0        0              0    3080.80   1.39   1.39   1.39
89   2557      0      0        0              0    3586.96   1.40   1.40   1.40
94   2552      0      0        0              0    3301.52   1.29   1.29   1.29
99    889      0      0        0              0    1189.22   1.34   1.34   1.34
104  2435      0      0        0              0    3273.37   1.34   1.34   1.34
109  2542      0      0        0              0    3305.36   1.30   1.30   1.30
114  2553      0      0        0              0    3336.77   1.31   1.31   1.31
119  2547      0      0        0              0    3417.31   1.34   1.34   1.34
124  2553      0      0        0              0    3369.70   1.32   1.32   1.32
129  2478      0      0        0              0    3301.94   1.33   1.33   1.33
134  2396      0      0        0              0    3283.48   1.37   1.37   1.37
139  2494      0      0        0              0    3295.57   1.32   1.32   1.32
5   64853      0      0        0              0 6732989.28 103.66 103.95 103.82
10   1882      0      0        0              0  195385.48 103.82 103.82 103.82
15   2416      0      0        0              0  250685.85 103.76 103.76 103.76
20   2541      0      0        0              0  263804.84 103.82 103.82 103.82
25   2331      0      0        0              0  241931.69 103.79 103.79 103.79
30   2482      0      0        0              0  257477.96 103.74 103.74 103.74
35   2497      0      0        0              0  258963.87 103.71 103.71 103.71
40   2367      0      0        0              0  245650.81 103.78 103.78 103.78
45   2507      0      0        0              0  260066.15 103.74 103.74 103.74
50   2453      0      0        0              0  254380.27 103.70 103.70 103.70
55   2530      0      0        0              0  262682.56 103.83 103.83 103.83
60   2515      0      0        0              0  261142.26 103.83 103.83 103.83
65   2526      0      0        0              0  262156.36 103.78 103.78 103.78
70   2532      0      0        0              0  263103.16 103.91 103.91 103.91
75   2523      0      0        0              0  262044.33 103.86 103.86 103.86
80   2533      0      0        0              0  263302.56 103.95 103.95 103.95
85   2222      0      0        0              0  230957.57 103.94 103.94 103.94
90   2557      0      0        0              0  265696.59 103.91 103.91 103.91
95   2552      0      0        0              0  264930.01 103.81 103.81 103.81
100   889      0      0        0              0   92337.05 103.87 103.87 103.87
105  2435      0      0        0              0  253103.88 103.94 103.94 103.94
110  2542      0      0        0              0  263954.16 103.84 103.84 103.84
115  2553      0      0        0              0  265232.96 103.89 103.89 103.89
120  2547      0      0        0              0  264509.77 103.85 103.85 103.85
125  2553      0      0        0              0  264647.30 103.66 103.66 103.66
130  2478      0      0        0              0  257104.89 103.75 103.75 103.75
135  2396      0      0        0              0  248715.82 103.80 103.80 103.80
140  2494      0      0        0              0  259021.10 103.86 103.86 103.86
1   64853      0      0        0              0  422448.00   1.00  12.00   6.51
6    1882      0      0        0              0   11969.00   1.00  12.00   6.36
11   2416      0      0        0              0   16141.00   1.00  12.00   6.68
16   2541      0      0        0              0   16612.00   1.00  12.00   6.54
21   2331      0      0        0              0   14754.00   1.00  12.00   6.33
26   2482      0      0        0              0   15956.00   1.00  12.00   6.43
31   2497      0      0        0              0   16375.00   1.00  12.00   6.56
36   2367      0      0        0              0   15783.00   1.00  12.00   6.67
41   2507      0      0        0              0   16322.00   1.00  12.00   6.51
46   2453      0      0        0              0   15916.00   1.00  12.00   6.49
51   2530      0      0        0              0   16513.00   1.00  12.00   6.53
56   2515      0      0        0              0   16478.00   1.00  12.00   6.55
61   2526      0      0        0              0   16479.00   1.00  12.00   6.52
66   2532      0      0        0              0   16494.00   1.00  12.00   6.51
71   2523      0      0        0              0   16427.00   1.00  12.00   6.51
76   2533      0      0        0              0   16415.00   1.00  12.00   6.48
81   2222      0      0        0              0   14462.00   1.00  12.00   6.51
86   2557      0      0        0              0   16678.00   1.00  12.00   6.52
91   2552      0      0        0              0   16635.00   1.00  12.00   6.52
96    889      0      0        0              0    5219.00   1.00  12.00   5.87
101  2435      0      0        0              0   16109.00   1.00  12.00   6.62
106  2542      0      0        0              0   16643.00   1.00  12.00   6.55
111  2553      0      0        0              0   16661.00   1.00  12.00   6.53
116  2547      0      0        0              0   16594.00   1.00  12.00   6.52
121  2553      0      0        0              0   16643.00   1.00  12.00   6.52
126  2478      0      0        0              0   16323.00   1.00  12.00   6.59
131  2396      0      0        0              0   15771.00   1.00  12.00   6.58
136  2494      0      0        0              0   16076.00   1.00  12.00   6.45
    median    SD   CV   IQR Skewness Kurtosis
3     0.20 14.91 2.08  7.20     3.63    19.51
8     0.20 15.90 2.03  8.40     3.27    14.37
13    0.60 16.15 2.00  9.00     3.97    27.17
18    0.40 14.84 1.97  8.40     3.31    15.33
23    0.20 15.55 2.17  6.70     3.77    19.49
28    0.40 15.39 1.96  9.00     3.29    14.76
33    0.40 15.63 1.93  9.00     2.94    10.39
38    0.40 16.52 2.11  7.60     3.68    18.84
43    0.60 14.98 1.95  8.20     3.13    13.32
48    0.40 14.13 1.96  7.80     3.07    11.67
53    0.40 15.68 1.98  8.80     3.26    14.42
58    0.40 14.74 2.00  7.60     3.40    16.45
63    0.50 15.78 2.05  8.40     4.11    30.95
68    0.00 13.68 2.34  5.20     4.82    37.56
73    0.20 14.66 2.18  6.00     3.70    18.88
78    0.20 14.06 2.25  5.80     4.42    31.56
83    0.20 12.43 2.22  5.00     3.70    19.27
88    0.20 14.26 2.10  7.00     3.88    22.77
93    0.20 14.38 2.10  6.40     3.50    16.40
98    0.00 10.40 2.92  0.00     4.01    18.22
103   0.00 14.82 2.31  5.60     4.45    30.06
108   0.20 13.50 2.08  6.35     3.36    15.21
113   0.20 14.21 2.24  5.40     4.43    31.43
118   0.40 15.04 2.03  7.60     3.39    15.14
123   0.40 16.24 2.02  8.20     3.25    13.40
128   0.40 16.01 2.03  8.20     3.59    19.16
133   0.40 15.01 1.93  8.60     3.03    11.55
138   0.20 14.43 2.05  7.20     3.36    15.43
2    16.00  8.81 0.56 15.00     0.01    -1.20
7    16.00  8.80 0.56 15.00     0.01    -1.20
12   16.00  8.79 0.56 15.00     0.00    -1.19
17   16.00  8.81 0.56 15.00     0.01    -1.20
22   16.00  8.80 0.56 15.00     0.01    -1.19
27   16.00  8.80 0.56 15.00     0.02    -1.19
32   16.00  8.81 0.56 15.00     0.00    -1.20
37   16.00  8.84 0.57 15.00     0.02    -1.20
42   16.00  8.79 0.56 15.00     0.00    -1.19
47   16.00  8.82 0.56 15.00     0.01    -1.20
52   16.00  8.82 0.56 15.00     0.01    -1.20
57   16.00  8.78 0.56 15.00     0.00    -1.19
62   16.00  8.80 0.56 15.00     0.02    -1.19
67   16.00  8.80 0.56 15.00    -0.01    -1.19
72   16.00  8.82 0.56 15.00    -0.01    -1.20
77   16.00  8.80 0.56 15.00     0.01    -1.20
82   16.00  8.81 0.56 15.00     0.01    -1.20
87   16.00  8.80 0.56 15.00     0.01    -1.19
92   16.00  8.81 0.56 15.00     0.00    -1.20
97   16.00  9.02 0.56 17.00    -0.06    -1.27
102  16.00  8.81 0.56 15.00     0.01    -1.19
107  16.00  8.78 0.56 15.00     0.00    -1.19
112  16.00  8.80 0.56 15.00     0.01    -1.20
117  16.00  8.81 0.56 15.00     0.00    -1.19
122  16.00  8.81 0.56 15.00     0.01    -1.20
127  16.00  8.80 0.56 15.00     0.00    -1.19
132  16.00  8.79 0.56 15.00     0.01    -1.20
137  16.00  8.78 0.56 15.00    -0.01    -1.19
4     1.34  0.04 0.03  0.08     0.59    -0.71
9     1.31  0.00 0.00  0.00      NaN      NaN
14    1.38  0.00 0.00  0.00      NaN      NaN
19    1.32  0.00 0.00  0.00      NaN      NaN
24    1.28  0.00 0.00  0.00      NaN      NaN
29    1.38  0.00 0.00  0.00      NaN      NaN
34    1.31  0.00 0.00  0.00      NaN      NaN
39    1.29  0.00 0.00  0.00      NaN      NaN
44    1.44  0.00 0.00  0.00      NaN      NaN
49    1.44  0.00 0.00  0.00      NaN      NaN
54    1.37  0.00 0.00  0.00      NaN      NaN
59    1.34  0.00 0.00  0.00      NaN      NaN
64    1.41  0.00 0.00  0.00      NaN      NaN
69    1.30  0.00 0.00  0.00      NaN      NaN
74    1.29  0.00 0.00  0.00      NaN      NaN
79    1.37  0.00 0.00  0.00      NaN      NaN
84    1.39  0.00 0.00  0.00      NaN      NaN
89    1.40  0.00 0.00  0.00      NaN      NaN
94    1.29  0.00 0.00  0.00      NaN      NaN
99    1.34  0.00 0.00  0.00      NaN      NaN
104   1.34  0.00 0.00  0.00      NaN      NaN
109   1.30  0.00 0.00  0.00      NaN      NaN
114   1.31  0.00 0.00  0.00      NaN      NaN
119   1.34  0.00 0.00  0.00      NaN      NaN
124   1.32  0.00 0.00  0.00      NaN      NaN
129   1.33  0.00 0.00  0.00      NaN      NaN
134   1.37  0.00 0.00  0.00      NaN      NaN
139   1.32  0.00 0.00  0.00      NaN      NaN
5   103.82  0.08 0.00  0.10    -0.07    -0.68
10  103.82  0.00 0.00  0.00      NaN      NaN
15  103.76  0.00 0.00  0.00      NaN      NaN
20  103.82  0.00 0.00  0.00      NaN      NaN
25  103.79  0.00 0.00  0.00      NaN      NaN
30  103.74  0.00 0.00  0.00      NaN      NaN
35  103.71  0.00 0.00  0.00      NaN      NaN
40  103.78  0.00 0.00  0.00      NaN      NaN
45  103.74  0.00 0.00  0.00      NaN      NaN
50  103.70  0.00 0.00  0.00      NaN      NaN
55  103.83  0.00 0.00  0.00      NaN      NaN
60  103.83  0.00 0.00  0.00      NaN      NaN
65  103.78  0.00 0.00  0.00      NaN      NaN
70  103.91  0.00 0.00  0.00      NaN      NaN
75  103.86  0.00 0.00  0.00      NaN      NaN
80  103.95  0.00 0.00  0.00      NaN      NaN
85  103.94  0.00 0.00  0.00      NaN      NaN
90  103.91  0.00 0.00  0.00      NaN      NaN
95  103.81  0.00 0.00  0.00      NaN      NaN
100 103.87  0.00 0.00  0.00      NaN      NaN
105 103.94  0.00 0.00  0.00      NaN      NaN
110 103.84  0.00 0.00  0.00      NaN      NaN
115 103.89  0.00 0.00  0.00      NaN      NaN
120 103.85  0.00 0.00  0.00      NaN      NaN
125 103.66  0.00 0.00  0.00      NaN      NaN
130 103.75  0.00 0.00  0.00      NaN      NaN
135 103.80  0.00 0.00  0.00      NaN      NaN
140 103.86  0.00 0.00  0.00      NaN      NaN
1     7.00  3.45 0.53  6.00    -0.01    -1.21
6     6.00  3.51 0.55  6.00     0.03    -1.24
11    7.00  3.47 0.52  6.00    -0.10    -1.19
16    7.00  3.44 0.53  6.00    -0.01    -1.20
21    6.00  3.40 0.54  6.00     0.08    -1.17
26    6.00  3.42 0.53  6.00     0.00    -1.20
31    7.00  3.44 0.53  6.00    -0.02    -1.20
36    7.00  3.40 0.51  6.00    -0.08    -1.16
41    7.00  3.45 0.53  6.00     0.00    -1.21
46    7.00  3.46 0.53  6.00     0.00    -1.22
51    7.00  3.44 0.53  6.00     0.00    -1.20
56    7.00  3.44 0.52  6.00    -0.02    -1.21
61    7.00  3.44 0.53  5.75    -0.01    -1.21
66    7.00  3.46 0.53  6.00     0.00    -1.22
71    7.00  3.43 0.53  5.00     0.00    -1.20
76    6.00  3.44 0.53  5.00     0.00    -1.20
81    6.00  3.54 0.54  7.00     0.02    -1.27
86    7.00  3.45 0.53  6.00    -0.01    -1.21
91    7.00  3.45 0.53  6.00    -0.01    -1.21
96    6.00  3.42 0.58  6.00     0.16    -1.22
101   7.00  3.42 0.52  6.00    -0.06    -1.19
106   7.00  3.44 0.53  6.00    -0.02    -1.20
111   7.00  3.45 0.53  6.00    -0.01    -1.21
116   7.00  3.45 0.53  6.00     0.00    -1.21
121   7.00  3.45 0.53  6.00    -0.01    -1.21
126   7.00  3.44 0.52  6.00    -0.03    -1.21
131   7.00  3.48 0.53  7.00    -0.04    -1.23
136   6.00  3.42 0.53  6.00     0.03    -1.18</code></pre>
</div>
</div>
</section>
<section id="temporal-rainfall-analysis" class="level1">
<h1>4. Temporal Rainfall Analysis</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create monthly time series object</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>monthly_station_rain <span class="ot">&lt;-</span> weather_active <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MonthYear =</span> <span class="fu">floor_date</span>(Date, <span class="st">"month"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Station, MonthYear) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MonthlyRain =</span> <span class="fu">sum</span>(Daily.Rainfall.Total..mm.))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>monthly_station_rain <span class="ot">&lt;-</span> monthly_station_rain <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MonthYear =</span> <span class="fu">yearmonth</span>(MonthYear)) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> MonthYear, <span class="at">key =</span> Station)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>monthly_station_rain</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tsibble: 2,213 x 3 [1M]
# Key:       Station [27]
# Groups:    Station [27]
   Station        MonthYear MonthlyRain
   &lt;fct&gt;              &lt;mth&gt;       &lt;dbl&gt;
 1 Botanic Garden  2018 Jan       404. 
 2 Botanic Garden  2018 Feb        22.2
 3 Botanic Garden  2018 Mar       222  
 4 Botanic Garden  2018 Apr       229. 
 5 Botanic Garden  2018 May       219  
 6 Botanic Garden  2018 Jun       296. 
 7 Botanic Garden  2018 Jul        95.2
 8 Botanic Garden  2018 Aug       120. 
 9 Botanic Garden  2018 Sep       227. 
10 Botanic Garden  2018 Oct       200. 
# â„¹ 2,203 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>seasonal_rain <span class="ot">&lt;-</span> monthly_station_rain <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill_gaps</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Station) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MonthlyRain =</span> <span class="fu">na_interpolation</span>(MonthlyRain)) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ts_decomposition <span class="ot">&lt;-</span> <span class="cf">function</span>(station_name) {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  seasonal_rain <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Station <span class="sc">==</span> station_name) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gg_tsdisplay</span>(MonthlyRain) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Monthly Rainfall in"</span>, station_name))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_decomposition</span>(<span class="st">"Bukit Panjang"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>stl_decomposition <span class="ot">&lt;-</span> <span class="cf">function</span>(station_name) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  seasonal_rain <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Station <span class="sc">==</span> station_name) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">model</span>(<span class="at">stl =</span> <span class="fu">STL</span>(MonthlyRain)) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"STL Decomposition for"</span>, station_name))</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stl_decomposition</span>(<span class="st">"Bukit Panjang"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>stl_residuals <span class="ot">&lt;-</span> <span class="cf">function</span>(station_name) {</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  model_fit <span class="ot">&lt;-</span> seasonal_rain <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Station <span class="sc">==</span> station_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">model</span>(<span class="fu">ETS</span>(MonthlyRain))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>(model_fit) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Residuals Components for"</span>, station_name))</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stl_residuals</span>(<span class="st">"Bukit Panjang"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>detect_changepoints <span class="ot">&lt;-</span> <span class="cf">function</span>(station_name) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  station_data <span class="ot">&lt;-</span> seasonal_rain <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Station <span class="sc">==</span> station_name) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(MonthlyRain)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  cpt_result <span class="ot">&lt;-</span> <span class="fu">cpt.mean</span>(station_data, <span class="at">method =</span> <span class="st">"PELT"</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    cpt_result,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Change Points in Monthly Rainfall (Mean) for"</span>, station_name),</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"Month Index"</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Rainfall (mm)"</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>changepoint_res <span class="ot">&lt;-</span> <span class="fu">detect_changepoints</span>(<span class="st">"Bukit Panjang"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>plot_changepoints <span class="ot">&lt;-</span> <span class="cf">function</span>(station_name) {</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  station_data <span class="ot">&lt;-</span> seasonal_rain <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Station <span class="sc">==</span> station_name)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  rain <span class="ot">&lt;-</span> station_data<span class="sc">$</span>MonthlyRain</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  dates <span class="ot">&lt;-</span> station_data<span class="sc">$</span>MonthYear</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  cpt_result <span class="ot">&lt;-</span> <span class="fu">cpt.mean</span>(rain, <span class="at">method =</span> <span class="st">"PELT"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  change_indices <span class="ot">&lt;-</span> <span class="fu">cpts</span>(cpt_result)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  change_dates <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(dates[change_indices])</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(station_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(MonthYear), <span class="at">y =</span> MonthlyRain)) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> change_dates, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Monthly Rainfall with Change Points for"</span>, station_name),</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Rainfall (mm)"</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_changepoints</span>(<span class="st">"Bukit Panjang"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>